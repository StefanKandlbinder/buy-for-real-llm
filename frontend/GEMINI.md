This project is a Next.js application with a tRPC backend and a PostgreSQL database using Drizzle ORM.

**Key Technologies:**

- **Framework:** Next.js (with Turbopack)
- **Styling:** Tailwind CSS
- **UI Components:** Shadcn UI
- **API:** tRPC
- **Database:** PostgreSQL
- **ORM:** Drizzle ORM
- **Authentication:** Clerk
- **Schema Validation:** Zod
- **State Management:** React Query
- **File Storage:** Pinata

**Project Structure:**

- `src/app`: Contains the main application pages and layouts, following the App Router structure.
- `src/components`: Contains reusable React components, including UI components from Shadcn UI.
- `src/db`: Contains the Drizzle ORM schema (`schema.ts`) and database connection (`drizzle.ts`). The schema is organized into `src/db/schema/`.
- `src/trpc`: Contains the tRPC server and client implementation.
  - `src/trpc/server`: Server-side tRPC setup, including routers, context, and procedures.
  - `src/trpc/client`: Client-side tRPC setup, including the tRPC client and React Query provider.
- `src/actions`: Server Actions for form handling and mutations.
- `src/hooks`: Custom React hooks for data fetching and other client-side logic.
- `src/lib`: Utility functions and configuration.
- `drizzle`: Contains the database migration files generated by Drizzle Kit.

**Database Schema:**

- **groups:** Represents folders that can contain media and other groups, forming a hierarchical structure. It has a self-referencing relationship to model parent-child relationships.
- **media:** Stores information about uploaded media (label, URL, description), with a relationship to a group.

**tRPC API:**

The tRPC API exposes the following routers:

- **groups:** Provides procedures for interacting with the `groups` table.
    - `getNestedGroups`: Fetches the entire hierarchy of groups and their associated images.
    - `createGroup`: Creates a new group.
    - `updateGroup`: Updates a group's name.
    - `deleteGroup`: Deletes a group and all its child groups and media. This also deletes the media from Pinata.
- **media:** Provides procedures for interacting with the `media` table.
    - `createImage`: Creates an image record in the database after upload.
    - `updateImage`: Updates an image's name.
    - `deleteImage`: Deletes an image record from the database.
    - `getImagesByGroup`: Fetches all images in a group.

**Authentication:**

Authentication is handled by Clerk. The `middleware.ts` file protects routes and redirects unauthenticated users to the sign-in page. It also handles role-based access control for the admin routes.

**Scripts:**

- `dev`: Starts the development server with Turbopack.
- `build`: Creates a production build of the application.
- `start`: Starts the production server.
- `lint`: Lints the codebase using Next.js's ESLint configuration.

**DB Scripts:**

- `db:generate`: Generates database migration files based on schema changes using Drizzle Kit.
- `db:migrate`: Applies generated migrations to the database.
- `db:studio`: Starts the Drizzle Studio to browse the database.